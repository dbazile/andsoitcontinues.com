<!doctype html>
<html lang="en-us" class="__blog__">
<head>
  <meta charset="utf-8"/>
  <title>CentOS 7 and Me | And So It Continues</title>
  <meta name="description" content="Not every day do I get to use the word discombobulation, but when I do, itâ€™s epic."/>
  <meta name="viewport" content="width=device-width, initial-scale=0.7, minimum-scale=0.7"/>
  <base href="../"/>
  <link rel="icon" href="images/favicon.png"/>
  <link rel="apple-touch-icon" href="images/favicon.png"/>
  <link rel="stylesheet" type="text/css" href="styles/common.css"/>
  <link rel="stylesheet" type="text/css" href="styles/blog.css"/>
  <link rel="stylesheet" type="text/css" href="styles/highlighter.css"/>
  <link rel="stylesheet" type="text/css" href="styles/portfolio.css"/>
  <link rel="stylesheet" type="text/css" href="styles/about.css"/>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Hammersmith+One|Abhaya+Libre:400,700|Cormorant+Garamond:400i,700i|Anonymous+Pro:400,400i,700,700i">
  <script src="scripts/libhljs.js"></script>
  <script src="scripts/utils.js"></script>
  <script src="scripts/transitioner.js"></script>
</head>
<body>

  <header>
    <nav class="navigation">
      <svg viewBox="0 0 760 150" preserveAspectRatio="xMidYMin">
        <line x1="-3000" y1="140" x2="3000" y2="140" />
        <g class="navigation__item" transform="translate(0, 112), rotate(-45)">
          <a class="navigation__link navigation__link--blog" xlink:href="index.html">
            <circle cx="0" cy="40" r="6" />
            <path d="M0,40 l0,-40 l300,0 l0,40 z" />
            <text x="4" y="30">blog</text>
          </a>
        </g>
        <g class="navigation__item" transform="translate(75, 112), rotate(-45)">
          <a class="navigation__link navigation__link--portfolio" xlink:href="portfolio/index.html">
            <circle cx="0" cy="40" r="6" />
            <path d="M0,40 l0,-40 l300,0 l0,40 z" />
            <text x="4" y="30">portfolio</text>
          </a>
        </g>
        <g class="navigation__item" transform="translate(150, 112), rotate(-45)">
          <a class="navigation__link navigation__link--about" xlink:href="about.html">
            <circle cx="0" cy="40" r="6" />
            <path d="M0,40 l0,-40 l300,0 l0,40 z" />
            <text x="4" y="30">about</text>
          </a>
        </g>
        <a class="navigation__brand navigation__link" xlink:href="index.html">
          <g transform="translate(685, 88) scale(0.75)">
            <rect x="-5" y="-5" width="110" height="70" rx="20" />
            <path d="M48.361541,21.4785721 C49.5995624,21.5647052 52.1865138,21.7221366 53.9601115,21.6740356 L52.7250151,35.2830673 L48.7168154,34.0165864 L47.97067,36.1591957 L54.76234,38.4911427 L56.2416532,21.8947542 L57.9443369,28.0567191 L56.2924646,27.7733329 L55.8643707,29.0485707 L60.430706,29.8987287 L58.0285547,19.9783949 C62.1511986,17.3864329 68.192391,12.6797593 68.192391,12.6797593 C68.192391,12.6797593 64.9901324,10.7787296 61.806536,10.9837257 C58.9806297,11.1656962 52.0689189,16.6492921 50.5519,17.8788506 L50.5374543,17.7703046 C50.6653863,17.077182 50.5665284,16.4247429 50.2250378,15.8363752 C49.1332375,13.9551876 45.9305152,11.4314407 44.5135743,11.3355759 C44.4945643,11.334307 44.4749747,11.3336148 44.4539941,11.3336148 C43.6009781,11.3336148 41.1825344,12.5308286 39.3707881,13.5561548 C37.4499662,14.6430837 35.1918325,16.1100109 34.6144615,16.9671412 C34.1605031,17.641132 33.9258553,18.7543548 33.8607381,19.9111827 L30.4668926,20.3565091 L30.7660048,22.6040592 L33.9446517,22.1869703 C34.045398,22.9291024 34.2159195,23.5569088 34.4379235,23.9250089 C34.5277085,24.0738979 34.6239117,24.2151597 34.7263432,24.3486939 L32.4778126,25.2235273 L33.3107631,27.3343624 L37.0801073,25.8678276 C37.4901032,25.9683767 37.9307201,26.0193832 38.3991914,26.0193832 C40.2057215,26.0193832 42.4209667,25.2666544 44.8056792,23.8424107 C45.9882177,23.1360711 47.004069,22.4090892 47.8395519,21.6816619 L48.361541,21.4785721 Z" />
            <path d="M14.1313192,0 L20,0 L6.09487842,29.58154 L19.5061287,60.3718378 L13.5853707,60.3718378 L0,29.5123171 L14.1313192,0 Z" />
            <path d="M85.8686808,0 L80,0 L93.9051216,29.58154 L80.4938713,60.3718378 L86.4146293,60.3718378 L100,29.5123171 L85.8686808,0 Z" />
            <path d="M47.9336063,60.3718378 L42.119488,60.3718378 L74.494558,0 L80.2894861,0 L47.9336063,60.3718378 Z" />
            <path d="M20.998765,22.3161539 L26.5753271,31.8016347 L37.7968773,30.1169642 L38.0606663,32.9296577 L24.7787018,34.8732031 L18.5030355,23.3755282 L20.998765,22.3161539 Z" />
          </g>
        </a>
      </svg>
    </nav>
  </header>

  <main>
  <article class="post post--text">
    <div class="post__timestamp block">
      <span
        class="post__year">2014</span><span
        class="post__monthAndDate">07/16</span>
    </div>
    <h1 class="post__title block">CentOS 7 and Me</h1>

    <section class="post__abstract block">
      <p>Not every day do I get to use the word <em>discombobulation</em>, but when I do, it&rsquo;s epic.</p>
    </section>

    <section class="post__content">
      <p>A few weeks ago, there was a small quiet celebration at my workstation when I read the headlines on HN that <a href="http://wiki.centos.org/Manuals/ReleaseNotes/CentOS7">CentOS 7 had been released</a>.  I dunno why, but whenever there&rsquo;s a new major release of a Linux distro, I get all excited to see what&rsquo;s included.</p>
<h2>An excuse to upgrade</h2>
<p>This week, I needed to build a brand new virtual machine, so I decided to take this opportunity to start with 7.  Using the updated, <em>very</em> well-designed installation interface, I performed the minimal install.  After booting up and attempting to install packages and configure services, I discovered that my cheese had been moved!</p>
<blockquote>
<p>People don&rsquo;t like it when you move their cheese. They are just trying to get through the maze, they have it all under control and then, poof, someone moved their cheese. Now it&rsquo;s a huge hassle to find it again. Change a hotkey or the case of the menus and all heck breaks loose.<span class="quoth"><a href="http://www.hanselman.com/blog/Windows8ProductivityWhoMovedMyCheeseOhThereItIs.aspx">Scott Hanselman</a></span></p>
</blockquote>
<h2>Impressions</h2>
<h3>Lightning-fast startup</h3>
<p>The progress bar is visible for a grand total of 1.5 seconds&mdash;which is a shame because it&rsquo;s a very pretty shade of purple&mdash;just before it vanishes and you&rsquo;re greeted by the login screen.</p>
<h3>Where&rsquo;s mysql?</h3>
<p>I can&rsquo;t find any official word on it (translation: <em>I&rsquo;m too lazy to look below the fold of the first page of Google results</em>), but according to <a href="https://www.digitalocean.com/community/questions/can-t-install-mysql-on-centos-7">this thread on DigitalOcean</a>, it looks like CentOS 7 has replaced MySQL with <a href="https://mariadb.org">MariaDB</a>.</p>
<p>I installed the <code>mariadb</code> and <code>mariadb-server</code> packages on my sandbox VM and it looked like most things are pretty much the same with a bit of rebranding&mdash;the <code>mysql</code> command still works.</p>
<h3>Introduction to systemd</h3>
<p>As a level 14 Senior Apprentice of the Init.d Dark Arts, I know where all of the components live, how to string things together manually and generally where to look when something&rsquo;s jacked up.  systemd is a completely unknown quantity.  I&rsquo;ve never used it or seen it used before.</p>
<p>Imagine my surprise when I get this cryptic response from <code>/sbin/service</code>:</p>
<pre><code>$ service httpd
The service command supports only basic LSB actions (start, stop, restart,
try-restart, reload, force-reload, status). For other actions, please try
to use systemctl.

$ service httpd status
Redirecting to /bin/systemctl status httpd.service
httpd.service
   Loaded: not-found (Reason: No such file or directory)
   Active: inactive (dead)
</code></pre>
<p>It took a good amount of Google-fu to get enough info on systemd to proceed with what I wanted to do, but ultimately I have chosen to embrace this opportunity to &ldquo;explore the frontier&rdquo;.  I very much like the status data it provides for running services, such as listing the hierarchy of process IDs and the log tail (thus proving yet again that I&rsquo;m a sucker for anything with fancy text formatting):</p>
<p><img src="/writing/attachments/systemd_status.png" class="figure center" /></p>
<p>One thing I don&rsquo;t like is the very cumbersome command name <code>systemctl</code>.  Typing that leads to a ton of time-wasting typos, so I set the following alias in my .profile:</p>
<pre><code>$ alias sc=systemctl
</code></pre>
<h3>Impenetrable iptables (and not in a good way)</h3>
<p>Out of the box, running <code>iptables -L</code> will show you that there are now almost 2 entire screens worth of firewall rules on a fresh install.  I don&rsquo;t personally have need for super complex firewall and NAT rules since I&rsquo;m not configuring servers sitting directly on the Internet&mdash;I&rsquo;m used to having a handful of ports open running on a (relatively) friendly network and blocking everything else.</p>
<p>A quick <code>yum remove firewalld</code> and I&rsquo;m back in my comfort zone.  Of course, on the way out, this uninvited dinner guest decides to take all of the silverware with it: <code>iptables -L</code> is completely empty.  I documented the process I took to configure iptables below.</p>
<p>I know at some point I&rsquo;ll have to actually face the music and look into firewalld, but today ain&rsquo;t it.</p>
<h3>Okay, well let&rsquo;s take a look at the network interface</h3>
<h4>Speaking of networks, where is <code>ifconfig</code>?</h4>
<p>The <code>/sbin/ifconfig</code> command comes in the <code>net-tools</code> package, which is not installed by default.  So, do that.</p>
<h4>Where&rsquo;d all these extra characters on my network interface come from?</h4>
<p>After installing ifconfig, it&rsquo;s time to look at the machine&rsquo;s assigned IP.  The interface name has a completely different naming convention:</p>
<p><img src="/writing/attachments/ifconfig_interface_name.png" class="figure center" /></p>
<p>As for the reason why the interface names have lost their brevity, <a href="http://wiki.centos.org/FAQ/CentOS7#head-62d45421abea0220e3038796e3dd5315906fa493">CentOS has posted the following reason in their FAQ</a>, emphasis mine:</p>
<blockquote>
<p>As to &ldquo;breaking expectations&rdquo;: The foregoing example uses a &lsquo;traditionally&rsquo; named network device of: eth0.  Other device names are also possible, including for example: em1 or p3p1 and such. <em>Like it or not, this change in approach in interface naming is the future path for Linux.</em></p>
</blockquote>
<h2>Some helpful stuff</h2>
<p>During my tooling around over the last few days, I&rsquo;ve amassed some information that might be useful to a future Dave (or even a real live actual other person).</p>
<h3>Removing firewalld and using simple iptables</h3>
<pre><code>$ yum remove firewalld

$ cat &lt;&lt; EOF &gt; /usr/lib/system.d/system/iptables.service

[Unit]
Description=iptables Firewall
DefaultDependencies=false

[Service]
type=oneshot
RemainAfterExit=yes
ExecStart=/sbin/iptables-restore /etc/sysconfig/iptables
EOF

$ iptables -L

Chain INPUT (policy ACCEPT)
target     prot opt source               destination
ACCEPT     tcp  --  anywhere             anywhere            tcp dpt:ssh
ACCEPT     all  --  anywhere             anywhere            state RELATED,ESTABLISHED
REJECT     all  --  anywhere             anywhere            reject-with icmp-port-unreachable

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination
REJECT     all  --  anywhere             anywhere            reject-with icmp-port-unreachable

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination

$ iptables-save | tee /etc/sysconfig/iptables
# Generated by iptables-save v1.4.21 on Tue Jul 15 19:16:48 2014
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
-A INPUT -j REJECT
-A FORWARD -j REJECT
COMMIT
# Completed on Tue Jul 15 19:16:48 2014
EOF
</code></pre>
<p>Please don&rsquo;t consider this to be a universal network protection solution.  This config works for me because my boxes are hosted on mostly internal development networks, not the Internet at large.</p>
<h3>How to convert a .VDI to a .VMDK that vSphere won&rsquo;t choke on</h3>
<p>When it comes time to actually deploy a VM to vSphere, the following command also helped me tons:</p>
<pre><code>C:\&gt; VBoxManage.exe clonehd thefile.vdi output.vmdk --format VMDK
</code></pre>
<p>Bear in mind that if there are snapshots, this is likely to get the wrong version of the image you want.</p>
<h2>References:</h2>
<ol>
<li><a href="http://www.techrepublic.com/blog/10-things/10-iptables-rules-to-help-secure-your-linux-box/">10 iptables rules to help secure your Linux box: (Tech Republic)</a></li>
<li><a href="https://github.com/vonSchlotzkow/systemd-gentoo-units/blob/master/sys-apps/systemd-units/files/services-desktop/iptables.service">Example iptables systemd service written by Jan Scholz (Github)</a></li>
<li><a href="http://wiki.centos.org/FAQ/CentOS7#head-62d45421abea0220e3038796e3dd5315906fa493">CentOS 7 FAQ (CentOS Wiki)</a></li>
<li><a href="http://www.hanselman.com/blog/Windows8ProductivityWhoMovedMyCheeseOhThereItIs.aspx">Windows 8 productivity: Who moved my cheese? Oh, there it is (Scott Hanselman)</a></li>
<li><a href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-clonevdi">VBoxManage: clonehd Command (VirtualBox Manual)</a></li>
</ol>
    </section>

    <section class="post__tags block">
      <h6>Tagged</h6>
      <ul>
        <li><a href="search.html?tagged=linux">linux</a></li>
        <li><a href="search.html?tagged=centos 7">centos 7</a></li>
        <li><a href="search.html?tagged=iptables">iptables</a></li>
        <li><a href="search.html?tagged=system administration">system administration</a></li>
        <li><a href="search.html?tagged=systemd">systemd</a></li>
      </ul>
    </section>
  </article>

  <script src="scripts/blogpost.js"></script>
  </main>

  <div class="scripts"></div>

  <div class="placeholders">
    <div class="placeholder placeholder--blog">
      <svg class="bookAndQull" viewBox="0 0 200 135" preserveAspectRatio="xMinYMin">
        <g class="bookAndQull__book">
          <g transform="translate(11.000000, 118.000000)">
            <path d="M178.285714,1.22222222 C178.285714,1.22222222 135.571429,3.66666667 113.285714,2.44444444 C101.273413,1.78565016 91,6.11111111 91,6.11111111 L91,6.72222222 C91,6.72222222 94.7142857,6.72222222 94.7142857,8.55555556 C98.4285714,8.55555556 99.3571429,6.11111111 99.3571429,6.11111111 L180.142857,6.11111103 L178.285714,1.22222222 Z M3.71428571,1.22222222 C3.71428571,1.22222222 46.4285714,3.66666667 68.7142857,2.44444444 C80.7265867,1.78565016 91,6.11111111 91,6.11111111 L91,6.72222222 C91,6.72222222 87.2857143,6.72222222 87.2857143,8.55555556 C83.5714286,8.55555556 82.6428571,6.11111111 82.6428571,6.11111111 L1.85714286,6.11111103 L3.71428571,1.22222222 Z" fill="#D8D8D8" />
            <path d="M0,6.11111111 L83.5714286,6.11111111 C85.4285714,6.11111111 85.4285714,8.61754635 87.2857143,8.55555556 C89.9074491,8.55555556 91.9285714,8.61754635 94.7142857,8.55555556 C96.5714286,8.61754635 96.5714286,6.11111111 98.4285714,6.11111111 L182,6.11111111 L182,8.61754645 L100.285714,8.61754635 C100.285714,8.61754635 98.4285714,11 96.5714286,11 C94.7142857,11 87.2857143,11 85.4285714,11 C83.5714286,11 81.7142857,8.61754645 81.7142857,8.61754645 L0,8.61754645 L0,6.11111111 Z" fill="#000000" />
            <path d="M174.571429,0.244440715 C174.571429,0.244440715 131.556114,1.0929764 116.241983,1.105141 C103.079923,1.11559613 91,5.20118881 91,5.20118881 L91,6.15121771 C91,6.15121771 102.69522,2.05914469 116.241983,2.04838398 C131.17141,2.03652496 176.428571,1.105141 176.428571,1.105141 L174.571429,0.244440715 Z M7.42857143,0.244440715 C7.42857143,0.244440715 50.4438863,1.0929764 65.7580175,1.105141 C78.9200767,1.11559613 91,5.20118881 91,5.20118881 L91,6.15121771 C91,6.15121771 79.30478,2.05914469 65.7580175,2.04838398 C50.8285896,2.03652496 5.57142857,1.105141 5.57142857,1.105141 L7.42857143,0.244440715 Z" fill="#D8D8D8" />
          </g>
        </g>
        <g class="bookAndQull__quill">
          <g transform="translate(111.000000, 39.000000)">
            <path d="M4.50000017,0.5 C5.00295876,0.500000001 5.9649475,1.07373114 7.09999847,2.19999981 C7.09966128,2.20702037 6.00000017,4.5 6.00000017,4.5 C6.00000017,4.5 7.43998197,2.56801981 7.52141647,2.65942058 C8.40172596,3.64746571 9.49999969,5.5 9.80000305,6.50000002 C10.0999985,7.5 10.4999997,9 10.4999997,9.5 C10.3026547,9.69734495 9.49999969,11 9.49999969,11 C9.49999969,11 10.4641492,10.6450549 10.8000031,9.5 C11.3744465,12.2913844 11.4376757,14.8339438 12,19 C12.1999969,21.2226134 12.4999997,32.5 12.8000031,34 C12.4999997,34.5 10.4999997,36.7000008 10.4999997,36.7000008 C10.4999997,36.7000008 11.9999997,35.5 12.6999969,34.7999992 C12.4999997,36 11.9999997,36.5 11.9999997,36.5 C11.9999997,36.5 12.4999997,36.5 12.9999997,36 C12.9999997,37.5 13.4000015,48 13.3000031,50 C13.3000031,53.1868603 12.6000064,55 12.3000031,56 C11.8000031,57 10.9999997,58.5 9.69999695,59.5 C10.2826011,59.1763315 11.9999997,58 12.9999997,56.5 C11.4999997,59.5 11.4999997,60.5 9.49999969,62.5 C9.54051366,62.6620558 11.4594857,60.8379442 11.4999997,61 C11.5690229,61.2760926 10.6046015,63.131214 9.49999969,64 C8.58573485,64.7190831 7.50000017,64.5 7.50000017,64.5 C7.50000017,64.5 8.00000017,65 10.4999997,64.5 C10.1582052,64.6708973 7.95987194,66 6.95987241,65.5 C6.86524688,65.5875955 8.99999969,67 8.99999969,68 C8.74852009,68 6.18823779,66.8106482 6.00000017,67 C6.40725004,67.2121375 7.25306024,67.9115057 7.50000017,68.5 C7.83508812,69.298564 7.50000017,70 7.50000017,70 C7.50000017,69 6.11820498,68 6.00000017,68 C6.50000017,69 6.50000017,70 6.50000017,70 C6.50000017,70 5.47322613,68.736613 5.00000017,68.5 C4.85915631,68.4295781 4.67754001,67.0102097 4.50000017,67 C4.01351824,66.9720241 3.99999993,69 3.99999993,69 C3.99999993,69 2.99999993,67.5 3.99999993,66.5 C2.99999993,66.5 2.00000005,65 2.00000005,65 C2.00000005,65 2.99999993,65.5 3.49999993,65.5 C2.49999993,65 1.50000005,63.2881091 1.50000005,63 C1.50000005,62.6910556 3.49999993,64.5 3.99999993,64.5 C2.49999993,63 2.49999993,63 2.00000005,62 C1.68303866,61.3660771 1.52452951,61 1.52452948,60.3529784 C2.49999993,61 2.99999993,61 2.99999993,61 C2.99999993,61 1.57269695,59.9445134 1.52452951,59.5 C0.999999989,57.9696884 0.602767455,51.1719538 0.5,48.5 C0.319426558,43.8050905 0.5,34 0.5,34 C0.5,34 0.923745095,24.3625202 1.52452951,16 C1.81129145,12.0084641 2.30220872,7.65650196 2.5,6 C3.11217652,0.873021678 3.50000017,0.499999998 4.50000017,0.5 Z" fill="#000000" />
            <path d="M3.34412179,6.97290924 C3.22691902,10.0104143 2.93767833,17.9190735 2.90808233,18.7633184 C2.65000082,26.1252588 2.5,31.3454798 2.5,33.5 C2.5,38.9442418 2.56231053,43.0442744 2.81298875,48.7096023 C3.1823706,57.0576322 3.87884263,64.4792075 5,73.0000035 C5,73.0000035 5.5,78.5 6,79 C6.5,79.0220794 7,74.0000035 7,74.0000035 C6,73.5 5.57130641,71.0701422 5.5,70.5000035 C4.51003381,62.5846148 4.15544512,56.4270031 3.81201125,48.6653977 C3.56211077,43.0176469 3.5,38.9307582 3.5,33.5 C3.5,31.3623538 3.64989747,26.1457298 3.90746843,18.7983531 C3.93705269,17.9544431 3.88282777,12.5367137 4,9.49999996 C4.0311289,8.69324259 4.00000002,2.9985316 4,1.99999996 C3.4632906,3.49853161 3.3851427,5.90978391 3.34412179,6.97290924 Z" fill="#7F7F7F" />
          </g>
        </g>
      </svg>
      <div class="placeholder__text">
        loading blog data
      </div>
    
      <style>
        .bookAndQull {}
    
        .bookAndQull__quill {
          animation: 3s infinite ease-in-out bookAndQuill__writingMotion;
        }
    
        @keyframes bookAndQuill__writingMotion {
          20% { transform: translateX(13px); }
          25% { transform: translateX( 8px); }
    
          30% { transform: translateX(23px); }
          35% { transform: translateX(18px); }
    
          40% { transform: translateX(36px); }
          45% { transform: translateX(31px); }
    
          50% { transform: translateX(49px); }
          55% { transform: translateX(44px); }
    
          60% { transform: translateX(65px); }
          80% { transform: translateX(65px); }
        }
      </style>
    </div>
  </div>

  <footer class="footer footer--standard block">
    <div class="footer__links">
      <a class="footer__link" href="https://github.com/dbazile" target="_blank" rel="nofollow"><img src="images/github-icon.svg" alt="My GitHub profile"/></a>
      <a class="footer__link" href="https://twitter.com/spoonchucks" target="_blank" rel="nofollow"><img src="images/twitter-icon.svg" alt="My Twitter profile"/></a>
      <a class="footer__link" href="https://instagram.com/spoonchucks" target="_blank" rel="nofollow"><img src="images/instagram-icon.svg" alt="My Instagram profile"/></a>
    </div>
    <p class="footer__copyright">&copy;2013-2016 David Bazile</p>
  </footer>
</body>
</html>